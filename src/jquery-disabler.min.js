(function($,undefined){var classDisablerContainer="hasDisabler";var classDisablerIgnoreReadOnly="disabler-ignore-readonly";var classDisablerHideReadOnly="disabler-hide-readonly";var classDisablerShowTextReadOnly="disabler-show-text-readonly";var classPanelsDatePicker="panels-date-picker";var classReadOnlyText="disabler-read-only-text";var classReadOnlyRemoveMe="disabler-read-only-display-as-text";var dataReadOnlyByDisabler="data-disabler-read-only";var dataHiddenInputs="disabler-hidden-inputs";var dataAnchorHref="data-disabler-anchor-href";var dataSavedEvents="disabler-saved-events";var dataReadOnlyDisplay="data-disabler-read-only-display";$.widget("dtg.disabler",{options:{disable:false,readonly:false,expression:"*:not(.disabler-ignore-readonly)",disabledClass:"ui-state-disabled"},_create:function(){this._initOptions();if(this.options.disable){this._setOption("disable",this.options.disable)}if(this.options.readonly){this._setOption("readonly",this.options.readonly)}if(!this.element.hasClass(classDisablerContainer)){this.element.addClass(classDisablerContainer)}},_initOptions:function(){this.options.disable=this._ensureBoolean(this.options.disable);this.options.readonly=this._ensureBoolean(this.options.readonly)},_ensureBoolean:function(value){var bool=false;if(this._isNotNullAndNotUndefined(value)){var flag=new String(value).toLowerCase();bool=flag==="true"}return bool},_setOption:function(key,value){this._initOptions();this.options[key]=value;var containerId=this.element.attr("id");switch(key){case'disable':this._doDisable(containerId,value);break;case'readonly':this.readOnly(containerId,this.options.readonly);break}},_getId:function(id){if(this._isNullOrUndefined(id)){id=this.element.attr("id")}if(this._isNotNullAndNotUndefined(id)){id=$.trim(id);if(id.length===0){id=null}}return id},enable:function(containerId){containerId=this._getId(containerId);if(this._isNullOrUndefined(containerId)){return}this._doDisable(containerId,false)},disable:function(containerId){containerId=this._getId(containerId);if(this._isNullOrUndefined(containerId)){return}this._doDisable(containerId,true)},_doDisable:function(containerId,disabling){var escapedId=this._escape(containerId);var bde=$.Event("beforeDisable");this._trigger("beforeDisable",bde,{'containerId':escapedId,'disabling':disabling,'element':this.element});if(bde.isDefaultPrevented()){return}this._readOnlyForDisable(containerId,disabling);this.options.disable=disabling;var ade=$.Event("afterDisable");this._trigger("afterDisable",ade,{'containerId':escapedId,'disabling':disabling,'element':this.element});this.options.disable=disabling},_readOnlyForDisable:function(containerId,readOnlyFlag){containerId=this._getId(containerId);if(this._isNullOrUndefined(containerId)){return}readOnlyFlag=this._defaultReadOnlyFlag(readOnlyFlag);this._doReadOnly(containerId,readOnlyFlag,true)},readOnly:function(containerId,readOnlyFlag){containerId=this._getId(containerId);if(this._isNullOrUndefined(containerId)){return}readOnlyFlag=this._defaultReadOnlyFlag(readOnlyFlag);this._doReadOnly(containerId,readOnlyFlag,false)},_defaultReadOnlyFlag:function(readOnlyFlag){if(readOnlyFlag===undefined){readOnlyFlag=true}return readOnlyFlag},_doReadOnly:function(containerId,readOnlyFlag,disabling){var escapedId=this._escape(containerId);var croe=$.Event("beforeReadOnly");this._trigger("beforeReadOnly",croe,{'containerId':escapedId,'readOnlyFlag':readOnlyFlag,'disabling':disabling,'element':this.element});if(croe.isDefaultPrevented()||readOnlyFlag===undefined){return}var hiddenInputs=[];var selector=this._formatSelectorForContainerId(escapedId);var topElement=$(selector);if(topElement.length===0){return}this._doReadOnlyIteration(topElement,readOnlyFlag,hiddenInputs,disabling);var plugin=this;var selector=this.options.expression+", span."+classReadOnlyText+", ."+classDisablerHideReadOnly;topElement.find(selector).each(function(index){var inp=$(this);var roie=$.Event("readOnlyIteration");plugin._trigger("readOnlyIteration",roie,{'input':inp,'index':index,'containerId':escapedId,'readOnlyFlag':readOnlyFlag,'disabling':disabling,'element':plugin.element});if(roie.isDefaultPrevented()){return true}var inputDisabler=inp.data("disabler");if(inputDisabler!==undefined){return true}plugin._doReadOnlyIteration(inp,readOnlyFlag,hiddenInputs,disabling)});this._processHiddenInputsOnReadOnly(escapedId,readOnlyFlag,hiddenInputs);this.options.readonly=readOnlyFlag;var aroe=$.Event("afterReadOnly");this._trigger("afterReadOnly",aroe,{'containerId':escapedId,'readOnlyFlag':readOnlyFlag,'disabling':disabling,'element':this.element})},_whatTypeAmI:function(inp){var type=inp.attr("type");if(type===undefined){if(inp[0]===undefined){type=""}else{type=inp[0].tagName}}return type.toLowerCase()},_doReadOnlyIteration:function(inp,readOnlyFlag,hiddenInputs,disabling){if(readOnlyFlag){this._turnReadOnlyOn(inp,hiddenInputs,disabling)}else{this._turnReadOnlyOff(inp)}},_turnReadOnlyOn:function(inp,hiddenInputs,disabling){if(this._hasAttribute(inp,dataReadOnlyByDisabler)){return}if(inp.attr("readonly")!==undefined||inp.attr("disabled")!==undefined){return}if((inp.hasClass("hasDatepicker")||inp.hasClass(classPanelsDatePicker))&&inp.datepicker("option","disabled")){return}this._setAttribute(inp,dataReadOnlyByDisabler,"true");if(inp.hasClass(classDisablerIgnoreReadOnly)){return}var type=this._whatTypeAmI(inp);if(!disabling){if(inp.hasClass(classDisablerHideReadOnly)){this._disableEvents(inp);hiddenInputs.push(inp);inp.hide();return}if(inp.hasClass(classDisablerShowTextReadOnly)){this._disableEvents(inp);this._showTextReadOnly(inp,type);return}}var trooe=$.Event("turnReadOnlyOn");this._trigger("turnReadOnlyOn",trooe,inp);if(trooe.isDefaultPrevented()){return}if(inp.data("accordion")!==undefined){}else if(inp.data("progressbar")!==undefined){inp.progressbar("disable")}else if(inp.data("slider")!==undefined){inp.slider("disable")}else if(inp.data("spinner")!==undefined){inp.spinner("disable")}else if(inp.data("tabs")!==undefined){inp.tabs("disable")}else if(inp.data("menu")!==undefined){inp.menu("disable")}else if(inp.data("datapicker")||inp.hasClass(classPanelsDatePicker)){inp.datepicker("disable")}else if(type==="a"){this._disableLink(inp)}else if(type==="submit"||type=="button"||type=="label"){if(inp.hasClass("ui-button")){inp.button("disable")}else if(type==="label"){inp.addClass(this.options.disabledClass)}else{inp.attr("disabled","true")}}else if(type==="select"||type=="checkbox"||type=="radio"){this._disableEvents(inp);inp.attr("disabled","true");inp.addClass(this.options.disabledClass)}else if(type==="text"||type==="textarea"){inp.attr("readonly","readonly");inp.attr("disabled","true");inp.addClass(this.options.disabledClass)}else{this._disableEvents(inp)}},_showTextReadOnly:function(inp,type){var stroe=$.Event("showTextReadOnly");this._trigger("showTextReadOnly",stroe,inp);if(stroe.isDefaultPrevented()){return}var plugin=this;var overrideText="";var text="";if(type==="a"){text=this._getTextForInput(inp,inp.text())}else if(type==="text"||type==="textarea"){text=this._getTextForInput(inp,inp.val())}else if(type==="radio"||type==="checkbox"){if(inp.prop("checked")){text=this._getTextForInput(inp,inp.val())}}else if(type==="select"){var options=[];inp.find('option:selected').each(function(index){var option=$(this);var optionText=plugin._getTextForSelectOption(option);options.push(optionText)});text=options.join(", ")}inp.wrap('<span class="'+classReadOnlyText+'"></span>');this._setAttribute(inp.parent("span."+classReadOnlyText),dataReadOnlyByDisabler,"true");var style="";if($.trim(text).length===0){style="style=\"display: none; \""}inp.parent().after('<span class="'+classReadOnlyRemoveMe+'" '+style+'>'+text+'</span>');inp.hide()},_getTextForInput:function(inp,elementText){var text=this._getAttribute(inp,dataReadOnlyDisplay);if(text===undefined){text=elementText}overrideText=this._getAttribute(inp.parent(),dataReadOnlyDisplay);if(overrideText!==undefined){text=overrideText}return text},_getTextForSelectOption:function(option){var optionText=this._getAttribute(option,dataReadOnlyDisplay);if(optionText===undefined){optionText=option.text()}return optionText},_turnReadOnlyOff:function(inp){if(this._hasNoAttribute(inp,dataReadOnlyByDisabler)){return}this._removeAttribute(inp,dataReadOnlyByDisabler);if(inp.hasClass(classReadOnlyText)){var ustroe=$.Event("undoShowTextReadOnly");this._trigger("undoShowTextReadOnly",ustroe,inp);if(!ustroe.isDefaultPrevented()){var span=inp.next('span.'+classReadOnlyRemoveMe);span.remove();var child=inp.children();child.unwrap();child.show()}}else{var trooe=$.Event("turnReadOnlyOff");this._trigger("turnReadOnlyOff",trooe,inp);if(!trooe.isDefaultPrevented()){var type=this._whatTypeAmI(inp);if(inp.data("accordion")!==undefined){}else if(inp.data("progressbar")!==undefined){inp.progressbar("enable")}else if(inp.data("slider")!==undefined){inp.slider("enable")}else if(inp.data("spinner")!==undefined){inp.spinner("enable")}else if(inp.data("tabs")!==undefined){inp.tabs("enable")}else if(inp.data("menu")!==undefined){inp.menu("enable")}else if(inp.data("datapicker")||inp.hasClass(classPanelsDatePicker)){inp.datepicker("enable")}else if(type==="a"){this._enableLink(inp)}else if(type==="submit"||type=="button"||type=="label"){if(inp.hasClass("ui-button")){inp.button("enable")}else if(type==="label"){inp.removeClass(this.options.disabledClass)}else{inp.removeAttr("disabled")}}else if(type==="select"||type=="checkbox"||type=="radio"){this._enableEvents(inp);inp.removeAttr("disabled");inp.removeClass(this.options.disabledClass)}else if(type==="text"||type==="textarea"){inp.removeAttr("readonly");inp.removeAttr("disabled");inp.removeClass(this.options.disabledClass)}else{this._enableEvents(inp)}}}},_processHiddenInputsOnReadOnly:function(containerId,readOnlyFlag,hiddenInputs){var escapedId=this._escapeValue(this.element.attr("id"));if(readOnlyFlag){if(hiddenInputs.length>0){$("#"+escapedId).data(dataHiddenInputs,hiddenInputs)}var phiroe=$.Event("processHiddenInputsReadOnly");this._trigger("processHiddenInputsReadOnly",phiroe,{'containerId':escapedId,'hiddenInput':hiddenInput,'element':this.element})}else{hiddenInputs=$("#"+escapedId).data(dataHiddenInputs);if(hiddenInputs!==undefined){for(var i=0;i<hiddenInputs.length;i++){var hiddenInput=hiddenInputs[i];this._enableEvents(hiddenInput);hiddenInput.show();var phinreie=$.Event("processHiddenInputsNotReadOnlyIteration");this._trigger("processHiddenInputsNotReadOnlyIteration",phinreie,{'containerId':escapedId,'hiddenInput':hiddenInput,'element':this.element})}$("#"+escapedId).removeData(dataHiddenInputs)}}},_disableLink:function(inp){this._disableEvents(inp);var href=inp.attr("href");if(href!==undefined){this._setAttribute(inp,dataAnchorHref,href);inp.attr("href","#")}inp.on("click",function(e){e.preventDefault()});inp.addClass(this.options.disabledClass)},_disableEvents:function(inp){var de=$.Event("disableEvents");this._trigger("disableEvents",de,inp);if(de.isDefaultPrevented()){return}var widgetEventPrefix=this.widgetEventPrefix;var events=inp.data("events");if(events===undefined){events=$._data(inp[0],"events")}if(events!==undefined){var savedEvents=[];$.each(events,function(eventName,handlers){$.each(handlers,function(index){var handler=handlers[index];if(handler!==undefined){var eventObj={'eventName':eventName,'handler':handler};if(eventName.indexOf(widgetEventPrefix)<0){savedEvents.push(eventObj);inp.unbind(eventName)}}})});inp.data(dataSavedEvents,savedEvents)}},_enableLink:function(inp){inp.unbind();this._enableEvents(inp);var href=this._getAttribute(inp,dataAnchorHref);if(href!==undefined){inp.attr("href",href);this._removeAttribute(inp,dataAnchorHref)}inp.removeClass(this.options.disabledClass)},_enableEvents:function(inp){var ee=$.Event("enableEvents");this._trigger("enableEvents",ee,inp);if(ee.isDefaultPrevented()){return}var savedEvents=inp.data(dataSavedEvents);if(savedEvents!==undefined){$.each(savedEvents,function(index){var savedEvent=savedEvents[index];var eventName=savedEvent.eventName;var handler=savedEvent.handler;inp.on(eventName,handler)})}inp.removeData(dataSavedEvents)},_escape:function(containerId){if(containerId===undefined){containerId=this.element.attr("id")}return this._escapeValue(containerId)},_escapeValue:function(str){str=str.replace(/\+/g,"\\+");str=str.replace(/\\/g,"\\");str=str.replace(/\//g,"\\/");str=str.replace(/!/g,"\\!");str=str.replace(/"/g,'\\"');str=str.replace(/#/g,"\\#");str=str.replace(/\$/g,"\\$");str=str.replace(/%/g,"\\%");str=str.replace(/&/g,"\\&");str=str.replace(/'/g,"\\'");str=str.replace(/\(/g,"\\(");str=str.replace(/\)/g,"\\)");str=str.replace(/\*/g,"\\*");str=str.replace(/,/g,"\\,");str=str.replace(/\./g,"\\.");str=str.replace(/:/g,"\\:");str=str.replace(/;/g,"\\;");str=str.replace(/\?/g,"\\?");str=str.replace(/@/g,"\\@");str=str.replace(/\[/g,"\\[");str=str.replace(/\]/g,"\\]");str=str.replace(/\^/g,"\\^");str=str.replace(/`/g,"\\`");str=str.replace(/\{/g,"\\{");str=str.replace(/\}/g,"\\}");str=str.replace(/\|/g,"\\|");str=str.replace(/\~/g,"\\~");return str},_isNotNullAndNotUndefined:function(obj){return obj!==undefined&&obj!=null},_isNullOrUndefined:function(obj){return obj===null||obj===undefined},_formatSelectorForContainerId:function(containerId){var panelId=this._escapeValue(this.element.attr("id"));if(panelId===containerId){containerId=null}var selector='#'+containerId+' ';if(this._isNullOrUndefined(containerId)){selector=''}if(selector===''){selector='#'+panelId}else{selector='#'+panelId+' '+selector}return selector+' '},_hasAttribute:function(inp,attrName){var attr=inp.attr(attrName);return typeof attr!=='undefined'&&attr!==false},_hasNoAttribute:function(inp,attrName){return!this._hasAttribute(inp,attrName)},_setAttribute:function(inp,attrName,attrValue){inp.attr(attrName,attrValue)},_removeAttribute:function(inp,attrName){inp.removeAttr(attrName)},_getAttribute:function(inp,attrName){return inp.attr(attrName)}});$.extend($.dtg.disabler,{version:"1.1.1"})}(jQuery));